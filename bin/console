#!/usr/bin/env php
<?php

date_default_timezone_set('UTC');

set_time_limit(0);

(@include_once __DIR__ . '/../vendor/autoload.php') || @include_once __DIR__ . '/../../../autoload.php';
include __DIR__ . '/../configs/global.php';

use Symfony\Component\Console\Application;
use Tlab\Command\RunMigrationCommand;
use Phinx\Console\Command;
use Tlab\DI\Container;
use Tlab\Libraries\Database;

$services   = include _CONFIG_BASE_PATH._DS.'configs/services.php';
$parameters = include _CONFIG_BASE_PATH._DS.'configs/parameters.php';
$DIContainer = new Container($services, $parameters);
$dbInstance = $DIContainer->get(Database::class);


$app = new Application('Pixel CLI Application', '0.1.0');

$app->addCommands(array(
            new Command\Init(),
            new Command\Create(),
            new Command\Migrate(),
            new Command\Rollback(),
            new Command\Status(),
            new Command\Breakpoint(),
            new Command\Test(),
            new Command\SeedCreate(),
            new Command\SeedRun(),
        ));
        
$app->add(new RunMigrationCommand());


$app->run();